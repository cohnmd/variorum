<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	
	<head>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
		<script type="text/javascript" src="scripts/searchJS.js"></script>
		<script type="text/javascript">
        var resultPath = "container.php?fr=";

        function listFragments() {



        }

        function textSearch() {

            query = document.getElementById("textQuery").value.trim();
            if (query != "") {
                document.getElementById("results").innerHTML = "Searching. . .";
                results = searchFragText(query, document.getElementById("contextBox").checked);
                displayResults(results);
            } else {
                document.getElementById("results").innerHTML = "Please enter a valid search term.";
            }
        }

        function tagSearch() {
            query = document.getElementById("tagQuery").value.trim();
            if (query != "") {
                document.getElementById("results").innerHTML = "Searching. . .";
                results = searchTags(query);
                displayResults(results);
            } else {
                document.getElementById("results").innerHTML = "Please enter a valid search term.";
            }
        }

        function bibSearch() {
            query = document.getElementById("bibQuery").value.trim();
            if (query != "") {
                document.getElementById("results").innerHTML = "Searching. . .";
                results = searchBib(query);
                displayResults(results);
            } else {
                document.getElementById("results").innerHTML = "Please enter a valid search term.";
            }
        }

        function displayResults(results) {
            i = 0;
            document.getElementById("results").innerHTML = "";
            while (i != results.length) {
                var resultLink = document.createElement('a');
                resultLink.href = resultPath + results[i].loc;
                var displayString = results[i].loc.split("fr");
                displayString = displayString[0] + " fr. " + displayString[1];
                resultLink.appendChild(document.createTextNode(displayString + ": " + results[i].hit));
                resultLink.appendChild(document.createElement('br'));
                document.getElementById("results").appendChild(resultLink);
                i++;
            }
        }

        function listFrags() {
            var query = "/demo/scripts/fragmentList.php";
            var response = new XMLHttpRequest();
            var fragmentList = [];
            response.open("GET", query, false);
            response.send();
            fragmentList = JSON.parse(response.responseText);
            document.getElementById("results").innerHTML = "";
            for (i = 0; i != fragmentList.length; i++) {
                var resultLink = document.createElement('a');
                resultLink.href = resultPath + fragmentList[i];
                var displayString = fragmentList[i].split("fr");
                displayString = displayString[0] + " fr. " + displayString[1];
                resultLink.appendChild(document.createTextNode(displayString));
                resultLink.appendChild(document.createElement('br'));
                document.getElementById("results").appendChild(resultLink);
            }
        }
    </script>
		<title>Search the Fragments</title>
	</head>
	
	<body>
		<h3>Search the fragments:</h3>
		<BR/>
		<label>Search the text of the fragments:
			<input type="text" id="textQuery"></input>
			<input type="button" value="submit" onclick="textSearch()"></input>(include the context of the fragment in search:
			<input type="checkbox" id="contextBox" checked=true></input>)</label>
		<BR>
			<BR>
				<label>Search fragment tags:
					<input type="text" id="tagQuery"></input>
					<input type="button" value="submit" onclick="tagSearch()"></input>
				</label>
				<BR>
					<BR>
						<label>Search bibliography:
							<input type="text" id="bibQuery"></input>
							<input type="button" value="submit" onclick="bibSearch()"></input>
						</label>
						<BR>
							<BR>
								<label>Or:
									<input type="button" value="List available fragments" onclick="listFrags()"></input>
								</label>
								<BR>
									<BR>
										<span id="results"></span>
	</body>
	
</html>